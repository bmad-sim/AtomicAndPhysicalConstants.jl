<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>For Developers · AtomicAndPhysicalConstants.jl</title><meta name="title" content="For Developers · AtomicAndPhysicalConstants.jl"/><meta property="og:title" content="For Developers · AtomicAndPhysicalConstants.jl"/><meta property="twitter:title" content="For Developers · AtomicAndPhysicalConstants.jl"/><meta name="description" content="Documentation for AtomicAndPhysicalConstants.jl."/><meta property="og:description" content="Documentation for AtomicAndPhysicalConstants.jl."/><meta property="twitter:description" content="Documentation for AtomicAndPhysicalConstants.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AtomicAndPhysicalConstants.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../units/">Setting Units: APCdef</a></li><li><a class="tocitem" href="../constants/">Constants</a></li><li><a class="tocitem" href="../species/">Species</a></li><li><a class="tocitem" href="../species_functions/">Species Functions</a></li><li class="is-active"><a class="tocitem" href>For Developers</a><ul class="internal"><li><a class="tocitem" href="#Species"><span>Species</span></a></li><li><a class="tocitem" href="#@APCdef"><span>@APCdef</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>For Developers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>For Developers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bmad-sim/AtomicAndPhysicalConstants.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bmad-sim/AtomicAndPhysicalConstants.jl/blob/main/docs/src/for_developers.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="For-Developers:-Code-Logic"><a class="docs-heading-anchor" href="#For-Developers:-Code-Logic">For Developers: Code Logic</a><a id="For-Developers:-Code-Logic-1"></a><a class="docs-heading-anchor-permalink" href="#For-Developers:-Code-Logic" title="Permalink"></a></h1><h2 id="Species"><a class="docs-heading-anchor" href="#Species">Species</a><a id="Species-1"></a><a class="docs-heading-anchor-permalink" href="#Species" title="Permalink"></a></h2><p>We provide a type <code>Species</code> for simple access to atomic and subatomic particle data. The constructor <code>Species(::String)</code> creates a <code>Species</code> instance from a given name. Users can retrieve data through getter functions such as <code>massof()</code> and <code>chargeof()</code>.</p><pre><code class="language-julia hljs">julia&gt; e = Species(&quot;electron&quot;) # create an &quot;electron&quot; Species

julia&gt; @APCdef unittype = Unitful # specify return units and type of the getter functions via @APCdef

julia&gt; massof(e) # get the electron mass
510998.95069 eV c⁻²

julia&gt; chargeof(e) # get the electron charge
-1.0 e
</code></pre><h3 id="Species-Type-Internal-Structure"><a class="docs-heading-anchor" href="#Species-Type-Internal-Structure">Species Type Internal Structure</a><a id="Species-Type-Internal-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Species-Type-Internal-Structure" title="Permalink"></a></h3><p>The <code>Species</code> type contains the following fields, defined in <a href="https://github.com/bmad-sim/AtomicAndPhysicalConstants.jl/blob/main/src/types.jl">types.jl</a></p><p>A <code>Species</code> stores the following information:</p><ul><li><code>name</code>: name of the particle to track</li><li><code>charge</code>: charge of the particle</li><li><code>mass</code>: mass of the particle</li><li><code>spin</code>: spin of the particle</li><li><code>moment</code>: magnetic moment of the particle</li><li><code>iso</code>: mass number of atomic isotope</li><li><code>kind</code>: The <code>kind</code> field classifies species into five types: <code>ATOM</code>, <code>HADRON</code>, <code>LEPTON</code>, <code>PHOTON</code>, and <code>NULL</code>.</li></ul><p><strong>Note</strong>: The <code>NULL</code> kind serves as a placeholder that can be used by Julia code. For example, if a <code>struct</code> has a <code>Species</code> component, a <code>NULL</code> species can be used as an initial value to indicate that the species component has not yet been set.</p><pre><code class="language-julia hljs">struct Species
  name::String # name of the particle to track
  charge::typeof(1u&quot;e&quot;) # charge of the particle, unit [e]
  mass::typeof(1.0u&quot;MeV/c^2&quot;) # mass of the particle, unit in [eV/c^2]
  spin::typeof(1.0u&quot;h_bar&quot;) # spin of the particle, unit in [ħ]
  moment::typeof(1.0u&quot;J/T&quot;) # magnetic moment of the particle (for now it&#39;s 0 unless we have a recorded value), unit in [J/T]
  iso::Float64 # if the particle is an atomic isotope, this is the mass number, otherwise 0
  kind::Kind.T #The kind field classifies species into five types: ATOM, HADRON, LEPTON, PHOTON, and NULL.
end</code></pre><p>Note that <code>charge</code>, <code>mass</code>, <code>spin</code>, and <code>moment</code> are stored as <code>Unitful.Quantity</code> types with specific units, as indicated in the comments.</p><h3 id="Species-Data-storage"><a class="docs-heading-anchor" href="#Species-Data-storage">Species Data storage</a><a id="Species-Data-storage-1"></a><a class="docs-heading-anchor-permalink" href="#Species-Data-storage" title="Permalink"></a></h3><p>All possible <code>Species</code> data is stored internally. When the constructor <code>Species(::String)</code> is called, it retrieves this data to build a new <code>Species</code>.</p><p>Information about subatomic and atomic particles is stored in two structs: <code>SubatomicSpecies</code> and <code>AtomicSpecies</code>. Dictionary maps link particle names (as strings) to these structures. The structs are defined in <a href="https://github.com/bmad-sim/AtomicAndPhysicalConstants.jl/blob/main/src/types.jl">types.jl</a>, and the dictionaries are defined in <a href="https://github.com/bmad-sim/AtomicAndPhysicalConstants.jl/blob/main/src/subatomic_species.jl">subatomic_species.jl</a> and <a href="https://github.com/bmad-sim/AtomicAndPhysicalConstants.jl/blob/main/src/isotopes.jl">isotopes.jl</a>. </p><p><code>SubatomicSpecies</code> has the following fields</p><pre><code class="language-julia hljs">struct SubatomicSpecies
  species_name::String              # common species_name of the particle
  charge::typeof(1.0u&quot;e&quot;)           # charge on the particle, in units of [e]
  mass::typeof(1.0u&quot;MeV/c^2&quot;)       # mass of the particle, in units of [eV/c^2]
  moment::typeof(1.0u&quot;J/T&quot;)         # magnetic moment, in units of [J/T]
  spin::typeof(1.0u&quot;h_bar&quot;)         # spin magnetic moment, in units of [ħ]
end;</code></pre><p><code>AtomicSpecies</code> has the following fields</p><pre><code class="language-julia hljs">struct AtomicSpecies
  Z::Int64                           # number of protons
  species_name::String               # periodic table element symbol
  mass::Dict{Int64,typeof(1.0 * u&quot;amu&quot;)}  # a dict to store the masses, keyed by isotope
end</code></pre><p><strong>Note:</strong> mass is a dictionary that maps mass number to isotope mass. <code>-1</code> maps to the average mass of common isotopes. Only existing isotopes is a key in the dictionary.</p><p>The function <code>subatomic_particle(name::String)</code> searches for a subatomic particle with corresponding <code>name</code> in the dictionary and builds a <code>Species</code> from <code>SubatomicSpecies</code>.</p><p>Similarly, <code>create_atomic_species(name::String, charge::Int, iso::Int)</code> searches for an atomic particle with corresponding <code>name</code> and <code>iso</code> in the dictionary and builds a <code>Species</code> with the corresponding <code>mass</code> and charge. Other fields—<code>spin</code>, <code>moment</code>, and <code>kind</code>—are computed accordingly.</p><h3 id="Species-Constructor"><a class="docs-heading-anchor" href="#Species-Constructor">Species Constructor</a><a id="Species-Constructor-1"></a><a class="docs-heading-anchor-permalink" href="#Species-Constructor" title="Permalink"></a></h3><p>The constructor parses the <code>name</code> and creates the according <code>Species</code>.</p><p>The constructor follows this order for parsing the <code>name</code>.</p><ul><li>Check whether it is a <code>Null Species</code>, if yes then creates a <code>Null Species</code> by setting <code>kind</code> to <code>NULL</code></li><li>Check whether they are Anti-particles.</li><li>Check whether it is a subatomic particles, if yes then use <code>subatomic_particle()</code> to create the <code>Species</code>.</li><li>Check whether it is an atomic species.<ul><li>Parse the <code>iso</code> number in front of the atomic symbol</li><li>Parse the <code>charge</code> number in the back of the atomic symbol</li><li>Call <code>create_atomic_species()</code> to create the <code>Species</code>.</li></ul></li></ul><h2 id="@APCdef"><a class="docs-heading-anchor" href="#@APCdef">@APCdef</a><a id="@APCdef-1"></a><a class="docs-heading-anchor-permalink" href="#@APCdef" title="Permalink"></a></h2><p><code>@APCdef</code> configures physical constants and <code>Species</code> getter functions using the specified:</p><ul><li>Unit system</li><li>Return type (<code>Float</code>, <code>Unitful</code>, or <code>DynamicQuantities</code>)</li><li>Tuple name</li><li>Tuple output flag (whether to wrap constants in a tuple</li></ul><h3 id="1-Predefined-Unit-Systems"><a class="docs-heading-anchor" href="#1-Predefined-Unit-Systems">1 Predefined Unit Systems</a><a id="1-Predefined-Unit-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#1-Predefined-Unit-Systems" title="Permalink"></a></h3><p>For convient usage, we predefined 3 unit systems:</p><ul><li><code>ACCELERATOR</code>: Uses high-energy physics units (<code>eV/c²</code>, <code>m</code>, <code>s</code>, <code>eV</code>, <code>e</code>)</li><li><code>MKS</code>: Standard SI units (<code>kg</code>, <code>m</code>, <code>s</code>, <code>J</code>, <code>C</code>)</li><li><code>CGS</code>: CGS units (<code>g</code>, <code>cm</code>, <code>s</code>, <code>J</code>, <code>C</code>)</li></ul><pre><code class="language-julia hljs">@APCdef unitsystem = MKS</code></pre><p>The user can specify a set of units quickly. </p><p>Since users can also define their own unit system. The units of the tuple must be in the order of “mass unit”, “length unit”, “time unit”, “energy unit”, and “charge unit”. The unit dimension is checked in macro.</p><h3 id="2-Ensuring-Single-Macro-Call"><a class="docs-heading-anchor" href="#2-Ensuring-Single-Macro-Call">2 Ensuring Single Macro Call</a><a id="2-Ensuring-Single-Macro-Call-1"></a><a class="docs-heading-anchor-permalink" href="#2-Ensuring-Single-Macro-Call" title="Permalink"></a></h3><p>Since <code>@APCdef</code> defines <code>massof()</code>, we check whether <code>@APCdef</code> is called in the module by check whether <code>massof()</code> is in the namespace.</p><h3 id="3-Extract-Keyword-Arguements"><a class="docs-heading-anchor" href="#3-Extract-Keyword-Arguements">3 Extract Keyword Arguements</a><a id="3-Extract-Keyword-Arguements-1"></a><a class="docs-heading-anchor-permalink" href="#3-Extract-Keyword-Arguements" title="Permalink"></a></h3><p>Julia macro does accept keyword arguments, so the next section sets default values</p><ul><li><code>unittype = :Float</code></li><li><code>unitsystem = ACCELERATOR</code></li><li><code>name = :APC</code></li><li><code>tupleflag = true</code></li></ul><p>And extracts keyword arguement variables from the marco expression input.</p><h3 id="4-Collecting-Constants"><a class="docs-heading-anchor" href="#4-Collecting-Constants">4 Collecting Constants</a><a id="4-Collecting-Constants-1"></a><a class="docs-heading-anchor-permalink" href="#4-Collecting-Constants" title="Permalink"></a></h3><ul><li>Extracts constants from the parent module whose names start with <code>__b_</code> and are not intermediate variables (e.g., those containing <code>_m_</code>).</li><li>Converts them to appropriate units based on the <code>conversion</code> dictionary.</li><li>Constructs a dictionary <code>constantsdict</code> with transformed values.</li></ul><h3 id="5-Unit-Type-Conversion"><a class="docs-heading-anchor" href="#5-Unit-Type-Conversion">5 Unit Type Conversion</a><a id="5-Unit-Type-Conversion-1"></a><a class="docs-heading-anchor-permalink" href="#5-Unit-Type-Conversion" title="Permalink"></a></h3><p>Based on <code>unittype</code>:</p><ul><li><strong><code>:Unitful</code></strong>: Constants retain their units.</li><li><strong><code>:Float</code></strong>: Extracts <code>.val</code> from quantities, stripping units.</li><li><strong><code>:DynamicQuantities</code></strong>: Converts values into <code>DynamicQuantities.Quantity</code></li></ul><h3 id="6-Output-Format:-Tuple-or-Individual-Variables"><a class="docs-heading-anchor" href="#6-Output-Format:-Tuple-or-Individual-Variables">6 Output Format: Tuple or Individual Variables</a><a id="6-Output-Format:-Tuple-or-Individual-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#6-Output-Format:-Tuple-or-Individual-Variables" title="Permalink"></a></h3><p>Determined by <code>tupleflag</code>:</p><ul><li><code>true</code> → constants are packed into a <code>NamedTuple</code> under the given module name.</li><li><code>false</code> → constants are returned as independent global variables.</li></ul><h3 id="7-Generate-Species-Getter-Functions"><a class="docs-heading-anchor" href="#7-Generate-Species-Getter-Functions">7 Generate Species Getter Functions</a><a id="7-Generate-Species-Getter-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#7-Generate-Species-Getter-Functions" title="Permalink"></a></h3><p>Generated via <code>generate_particle_property_functions(...)</code>:</p><ul><li><strong><code>massof</code></strong>: Returns the mass of a <code>Species</code> or species name.</li><li><strong><code>chargeof</code></strong>: Returns the charge.</li><li><strong><code>spinof</code></strong>: Returns the spin (except for null or atomic species).</li><li><strong><code>nameof</code></strong>: Returns a species&#39; name, including isotope/charge info unless <code>basename = true</code>.</li></ul><h3 id="8-Return-statement"><a class="docs-heading-anchor" href="#8-Return-statement">8 Return statement</a><a id="8-Return-statement-1"></a><a class="docs-heading-anchor-permalink" href="#8-Return-statement" title="Permalink"></a></h3><ul><li><code>APCconsts</code> stores the macro-defined name.</li><li><code>UNITS</code> holds a <code>NamedTuple</code> mapping physical quantity symbols (<code>:mass</code>, <code>:length</code>, etc.) to their respective units.</li><li>Species Getter Functions</li><li>Constants (either wrapped in named tuple or not)</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../species_functions/">« Species Functions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 22 August 2025 20:28">Friday 22 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
